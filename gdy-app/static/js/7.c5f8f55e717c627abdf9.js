webpackJsonp([7],{W3Iv:function(e,t,s){e.exports={default:s("wEtr"),__esModule:!0}},gSvA:function(e,t,s){var a=s("kM2E"),r=s("mbce")(!0);a(a.S,"Object",{entries:function(e){return r(e)}})},mbce:function(e,t,s){var a=s("lktj"),r=s("TcQ7"),n=s("NpIQ").f;e.exports=function(e){return function(t){for(var s,c=r(t),i=a(c),o=i.length,l=0,u=[];o>l;)n.call(c,s=i[l++])&&u.push(e?[s,c[s]]:c[s]);return u}}},nnf8:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("//Fk"),r=s.n(a),n=s("W3Iv"),c=s.n(n),i=s("BO1k"),o=s.n(i),l=s("d7EF"),u=s.n(l),d=s("mvHQ"),v=s.n(d),f=s("bOdI"),p=s.n(f),m=s("Dd8w"),h=s.n(m),g=s("Ylnc"),_=s("Au9i"),U={name:"SwitchUser",components:{Header:g.a},data:function(){return{savedUsers:[],currentUserId:"",manage:!1}},activated:function(){this.manage=!1;var e=h()({},localStorage),t=e.savedUsers;if(this.currentUserId=e.userId,void 0!==t)this.savedUsers=JSON.parse(t);else{var s=e,a=p()({},s.userId,s);this.savedUsers=a,localStorage.setItem("savedUsers",v()(a))}},methods:{switchUser:function(e){var t=this;e.userId!==localStorage.userId&&this.validateLoginEffect(e.userId).then(function(s){if(0==s.data.data.static){localStorage.clear();var a=!0,r=!1,n=void 0;try{for(var i,l=o()(c()(e));!(a=(i=l.next()).done);a=!0){var d=i.value,v=u()(d,2),f=v[0],p=v[1];localStorage.setItem(f,p)}}catch(e){r=!0,n=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw n}}t.$router.push({name:"index",params:{selected:"主页"}}),Object(_.Toast)("切换成功")}else 1==s.data.data.static&&(Object(_.Toast)("用户不存在"),t.deleteUser(e.userId))})},deleteUser:function(e){var t=JSON.parse(localStorage.getItem("savedUsers")||{});delete t[e],this.savedUsers=t,localStorage.setItem("savedUsers",v()(t))},plusUser:function(){this.$router.push({name:"login",params:{type:"plus"}})},validateLoginEffect:function(e){var t={id:e};return this.$axios.post("/api/userInfo/checkUserByID",t).then(function(e){return"200"==e.data.code?e:(Object(_.Toast)("请求失败,请稍后重试!"),r.a.reject())}).catch(function(e){Object(_.Toast)("服务超时,请稍后再试!")})}}},I={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"switch-user"},[s("Header",{attrs:{title:"切换用户"}},[s("template",{slot:"after"},[Object.keys(e.savedUsers).length>0?s("span",{on:{click:function(t){e.manage=!e.manage}}},[e._v(e._s(e.manage?"取消":"管理"))]):e._e()])],2),e._v(" "),s("div",{staticClass:"container"},[s("div",{staticClass:"tips"},[e._v("轻触头像以切换账号")]),e._v(" "),s("div",{staticClass:"user-list"},[e._l(e.savedUsers,function(t){return s("div",{key:t.userId,staticClass:"user-item active",on:{click:function(s){e.switchUser(t)}}},[s("img",{staticClass:"avatar",attrs:{src:t.headPortrait}}),e._v(" "),s("span",{staticClass:"name"},[e._v(e._s("null"!==t.nickName?t.nickName:"未设置姓名"))]),e._v(" "),e.currentUserId!==t.userId&&e.manage?s("van-button",{staticStyle:{"font-size":"6px","margin-left":"auto"},attrs:{type:"danger"},on:{click:function(s){s.stopPropagation(),e.deleteUser(t.userId)}}},[e._v("删除\n        ")]):e._e(),e._v(" "),e.currentUserId===t.userId?s("span",{staticClass:"current"},[e._v("当前登录")]):e._e()],1)}),e._v(" "),Object.keys(e.savedUsers).length<3?s("div",{staticClass:"user-item",on:{click:e.plusUser}},[s("van-icon",{staticClass:"avatar",attrs:{name:"plus",size:"30"}}),e._v(" "),s("span",{staticClass:"name"},[e._v("添加用户")])],1):e._e()],2)])],1)},staticRenderFns:[]};var k=s("VU/8")(U,I,!1,function(e){s("wPdz")},"data-v-31e300ee",null);t.default=k.exports},wEtr:function(e,t,s){s("gSvA"),e.exports=s("FeBl").Object.entries},wPdz:function(e,t){}});