webpackJsonp([29],{"092y":function(t,s,e){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var i=e("mvHQ"),a=e.n(i),o=e("bOdI"),c=e.n(o),l=(e("XmAh"),e("il3B")),r=(e("LOkV"),e("4duW")),n=e("tdg1"),h={name:"searchSingle",components:c()({loadAll:r.a,noGood:n.a},l.a.Component.name,l.a.Component),data:function(){return{value:"",defaultValue:"null",searchList:[],page:1,pageSize:12,isLoaded:!0,isOver:!1,resTotal:0,choosedList:[],show:!1,searchFlag:!0}},mounted:function(){var t=null==localStorage.search?this.$route.query.value:localStorage.search;this.search(t)},updated:function(){},activated:function(){localStorage.singleList&&(this.choosedList=JSON.parse(localStorage.singleList)),this.page=1,this.searchFlag=!0,this.searchList=[],this.search(),this.changfouce()},directives:{focus:{inserted:function(t){t.focus()}}},methods:{changfouce:function(){var t=this;setTimeout(function(){t.$refs.searchIpt.focus()},800)},loadedImg:function(){},back:function(){this.$router.go(-1),localStorage.removeItem("search")},addSingle:function(t){if(this.choosedList.length<5){for(var s=!1,e=0;e<this.choosedList.length;e++)if(this.choosedList[e].id==t.id){s=!0;break}if(s)this.$toast("该单品已存在");else{for(var i=0;i<this.searchList.length;i++)t.id==this.searchList[i].id&&(this.searchList[i].choosed=!0);this.choosedList.push(t)}}else this.$toast("最多只能选择5件单品");localStorage.singleList=a()(this.choosedList)},viewChoosedSingle:function(){this.choosedList.length>0?this.show=!0:this.$toast("您还未选择单品")},delSingle:function(t){for(var s=0;s<this.choosedList.length;s++)if(this.choosedList[s].id==t.id){this.choosedList.splice(s,1),0==this.choosedList.length&&(this.show=!1);for(var e=0;e<this.searchList.length;e++)t.id==this.searchList[e].id&&(this.searchList[e].choosed=!1);break}localStorage.singleList=a()(this.choosedList)},conChoosedSingle:function(){0==this.choosedList.length?this.$toast("您还未选择搭配单品"):this.$router.push({path:"/addCollocation",query:{choosedList:this.choosedList,recommentReason:this.$route.query.recommentReason,activeSuit:this.$route.query.activeSuit,collImgList:this.$route.query.collImgList,tempImgList:this.$route.query.tempImgList,collId:this.$route.query.collId}})},toSearch:function(t){this.page=1,this.$refs.searchIpt.blur(),this.searchList=[],this.search(t)},search:function(t){var s=this;s.value=s.value.replace(/\s*/g,""),""==s.value?s.defaultValue="null":s.defaultValue=s.value,s.$axios.get("/api/style/search/"+s.defaultValue+"?currentPage="+s.page+"&pageSize="+s.pageSize+"&brandId="+localStorage.brandId).then(function(t){var e=t.data;if(s.searchFlag=!1,"200"==e.code){s.resTotal=e.data.total,1==s.page?s.searchList=e.data.list:s.searchList=s.searchList.concat(e.data.list);for(var i=0;i<s.searchList.length;i++)s.$set(s.searchList[i],"choosed",!1);if(s.choosedList.length>0)for(var a=0;a<s.choosedList.length;a++)for(var o=0;o<s.searchList.length;o++)s.choosedList[a].id==s.searchList[o].id&&(s.searchList[o].choosed=!0)}}).catch(function(t){console.log(t)})},rescollRefresh:function(){this.page=1,this.search()},rescollLoadMore:function(){this.searchList.length<this.resTotal?(this.page++,this.search()):this.$refs.searchResScroll.update(!0)},toGoods:function(t){var s={path:"/goodsDetail2",query:{styleId:t,stamp:(new Date).getTime()}};localStorage.search=this.value,this.$router.push(s)}}},d={render:function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"searchSingle"},on:{touchmove:function(t){t.preventDefault()}}},[e("div",{staticClass:"hd_select"},[e("img",{attrs:{src:"static/images/dev/back@2x.png"},on:{click:t.back}}),t._v(" "),e("div",{staticClass:"hd_input_wrap"},[e("span",{staticClass:"icon select"}),t._v(" "),e("form",{staticStyle:{width:"100%"},attrs:{action:"javascript:return true"},on:{submit:function(t){t.preventDefault()}}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"value"}],ref:"searchIpt",attrs:{type:"search",placeholder:"商品款号、名称"},domProps:{value:t.value},on:{keyup:function(s){if(!("button"in s)&&13!==s.keyCode)return null;t.toSearch()},input:function(s){s.target.composing||(t.value=s.target.value)}}})])]),t._v(" "),e("div",{staticClass:"search",on:{click:function(s){t.toSearch()}}},[t._v("搜索")])]),t._v(" "),t.searchFlag?e("div",{staticStyle:{flex:"1",overflow:"hidden"}},[e("van-loading",{attrs:{color:"#00a2ea"}})],1):e("Scroll",{ref:"searchResScroll",staticClass:"searchResBody",attrs:{"update-data":[t.searchList],"refresh-data":[],probeType:3,listenScroll:!0,scrollX:!1,scrollY:!0,autoUpdate:!1},on:{pullingDown:t.rescollRefresh,pullingUp:t.rescollLoadMore}},[t.searchList.length>0?e("ul",{staticClass:"recommended"},t._l(t.searchList,function(s,i){return e("div",{key:i,staticClass:"keyStyle-item fl"},[e("div",{staticClass:"goods-img-box"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:s.imgUrl,expression:"item.imgUrl"}],staticClass:"goods-img",attrs:{alt:""}}),t._v(" "),e("div",{staticClass:"addIcon"},[s.choosed?e("img",{attrs:{src:"static/images/icon/a-reduce.png",alt:""},on:{click:function(e){e.stopPropagation(),t.delSingle(s)}}}):e("img",{attrs:{src:"static/images/icon/add1.png",alt:""},on:{click:function(e){e.stopPropagation(),t.addSingle(s)}}})])]),t._v(" "),e("div",{staticClass:"goods-num"},[t._v(t._s(s.styleNo))]),t._v(" "),e("div",{staticClass:"goods-stylePrice"},[e("div",{staticClass:"money-symbel"},[t._v("¥"+t._s(s.stylePrice))])])])})):e("div",{staticClass:"noData"},[e("noGood")],1)]),t._v(" "),e("div",{staticClass:"choosedBox"},[e("div",{staticClass:"chooseNums",on:{click:function(s){t.viewChoosedSingle()}}},[t._v("已选中："+t._s(t.choosedList.length)+"/5")]),t._v(" "),e("div",{staticClass:"conBtn",on:{click:function(s){t.conChoosedSingle()}}},[t._v("确认")])]),t._v(" "),e("van-popup",{attrs:{position:"bottom"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[e("ul",{staticClass:"ulList"},t._l(t.choosedList,function(s,i){return e("li",{key:i},[e("img",{attrs:{src:s.imgUrl,alt:""}}),t._v(" "),e("div",{staticClass:"baseInfo"},[e("div",{staticClass:"styleName"},[t._v(t._s(s.styleName))]),t._v(" "),e("div",{staticClass:"styleNo"},[t._v(t._s(s.styleNo))]),t._v(" "),e("div",{staticStyle:{color:"rgba(184, 5, 2, 1)"}},[t._v("￥"),e("span",[t._v(t._s(s.stylePrice))])])]),t._v(" "),e("div",{staticClass:"delBtn",on:{click:function(e){e.stopPropagation(),t.delSingle(s)}}},[t._v("删除")])])}))])],1)},staticRenderFns:[]};var u=e("VU/8")(h,d,!1,function(t){e("NZ5N")},"data-v-6763eb52",null);s.default=u.exports},NZ5N:function(t,s){}});