webpackJsonp([27],{bvJ8:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("//Fk"),o=a.n(i),r=a("Ylnc"),n=a("Au9i"),s={name:"",components:{Header:r.a},data:function(){return{title:"个人信息",currentDate:new Date,isPopShow:!1,datePicker:"",birMiniData:new Date(1960,1,1),birMaxDate:new Date,workMiniData:new Date(1990,1,1),workMaxDate:new Date,headPortrait:"",nickName:"",sexShow:!1,radio:"0",telePhone:"",birthday:"",job:"",entryTime:"",signLabel:"",isIosFlag:!1,imgStr:"",entry_day:"",birth_day:""}},activated:function(){this.initUserInfo()},created:function(){},mounted:function(){this.initUserInfoScroll(),this.isIos()},updated:function(){},methods:{updateInfos:function(){var t=this,e={userId:localStorage.getItem("userId"),headPortrait:t.imgStr,sex:t.radio,hireDate:t.entry_day,birthDate:t.birth_day};t.$axios.post("/api/userInfo/upUserInfo",e).then(function(e){var a=e.data;"200"==a.code?(Object(n.Toast)("修改成功"),localStorage.headPortrait=a.data.headPortrait,localStorage.sex=t.radio,t.headPortrait=a.data.headPortrait,t.radio=t.radio):Object(n.Toast)("修改失败！")}).catch(function(t){console.log(t)})},handleInputChange:function(t){var e,a=t.target.files[0],i=a.size,o=this;if(!("image/jpeg"==a.type||"image/png"==a.type))return Object(n.Toast)("上传图片只能是 JPG、PNG 格式!"),!1;i>=819200?((e=new FileReader).readAsDataURL(a),e.onloadend=function(){var t=e.result;o.imageCompress(t).then(function(t){o.imgStr=t,o.updateInfos()})}):((e=new FileReader).readAsDataURL(a),e.onloadend=function(){var t=e.result;o.imgStr=t,o.updateInfos()})},imageCompress:function(t){var e=new Image,a="";e.src=t;var i=new o.a(function(t,i){e.onload=function(){var i=document.createElement("canvas"),o=e.width,r=e.height,n=o/r,s=r,c=o;(o>1e3||r>1e3)&&(o>r?(c=1e3,s=1e3/n):(c=1e3*n,s=1e3)),i.width=c,i.height=s,i.getContext("2d").drawImage(e,0,0,c,s),a=i.toDataURL("image/jpeg",.3),t(a)}});return i.then(function(t){}),i},isIos:function(){var t=navigator.userAgent.toLowerCase(),e=-1!=t.indexOf("iphone")||-1!=t.indexOf("ipad");e&&(this.isIosFlag=!0)},initUserInfoScroll:function(){var t=this;t.$nextTick(function(){t.userInfoPage?t.userInfoPage.refresh():t.userInfoPage=new t.$BScroll(t.$refs.userInfoPage,{scrollX:!1,click:!0,scrollY:!0,useTransition:!1})})},beforeRead:function(t){return"image/png"===t.type||"image/jpeg"===t.type||(Object(n.Toast)("请上传 jpg或png 格式图片"),!1)},onRead:function(t){this.$refs.headerImg.src=t.content,this.imgStr=this.$refs.headerImg.src,this.updateInfos()},initUserInfo:function(){localStorage.getItem("userId");"null"!==localStorage.getItem("headPortrait")?this.headPortrait=localStorage.getItem("headPortrait"):this.headPortrait="/static/images/default/heder_default.png",this.nickName="null"!==localStorage.getItem("nickName")&&""!=localStorage.getItem("nickName")?localStorage.getItem("nickName"):"",this.birthday="null"!==localStorage.getItem("birth")?localStorage.getItem("birth"):"",this.telePhone="null"!==localStorage.getItem("telePhone")&&""!=localStorage.getItem("telePhone")?localStorage.getItem("telePhone"):"",this.job="null"!==localStorage.getItem("job")&&""!=localStorage.getItem("job")?localStorage.getItem("job"):"",this.entryTime="null"!==localStorage.getItem("hireDate")?localStorage.getItem("hireDate"):"",this.signLabel="null"!==localStorage.getItem("autoGraph")&&""!=localStorage.getItem("autoGraph")?localStorage.getItem("autoGraph"):"","null"!==localStorage.getItem("sex")?this.radio=localStorage.getItem("sex"):this.radio="0"},comfirmSex:function(){localStorage.getItem("userId");this.updateInfos()},updateUserInfo:function(){this.$router.push({path:"/updateInfo",query:{prePage:"nickName",nickName:this.nickName}})},updateSex:function(){this.sexShow=!0},updatePhone:function(){this.$router.push({path:"/updateInfo",query:{prePage:"telePhone",nickName:this.telePhone}})},updateWork:function(){this.$router.push({path:"/updateInfo",query:{prePage:"job",job:this.job}})},updateSign:function(){this.$router.push({path:"/updateInfo",query:{prePage:"sign",sign:this.signLabel}})},showDatePicker:function(t){this.isPopShow=!0,this.datePicker=t},cancelPicker:function(){this.isPopShow=!1,this.datePicker=""},confirmBirthPicker:function(t){var e=t,a=e.getMonth()+1,i=e.getDate();a>=1&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i);var o=e.getFullYear()+"-"+a+"-"+i,r=this,s={userId:localStorage.getItem("userId"),birthDate:o};r.$axios.post("/api/userInfo/upUserInfo",s).then(function(t){"200"==t.data.code?(Object(n.Toast)("保存成功"),localStorage.birth=o,r.birthday=o,r.isPopShow=!1):(Object(n.Toast)("保存失败！"),r.isPopShow=!1)}).catch(function(t){console.log(t)}),this.datePicker=""},confirmEntryPicker:function(t){var e=t,a=e.getMonth()+1,i=e.getDate();a>=1&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i);var o=e.getFullYear()+"-"+a+"-"+i,r=this,s={userId:localStorage.getItem("userId"),hireDate:o};r.$axios.post("/api/userInfo/upUserInfo",s).then(function(t){"200"==t.data.code?(Object(n.Toast)("保存成功"),localStorage.hireDate=o,r.entryTime=o,r.isPopShow=!1):(Object(n.Toast)("保存失败！"),r.isPopShow=!1)}).catch(function(t){console.log(t)}),this.datePicker=""},formatter:function(t,e){return"year"===t?e+"年":"month"===t?e+"月":"day"===t?e+"日":e}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"userinfo-wrap"},[a("Header",{attrs:{title:"个人信息"}}),t._v(" "),a("div",{ref:"userInfoPage",staticClass:"userInfoPage"},[a("div",[a("div",{staticClass:"box-li"},[a("div",{staticClass:"box-left avatar-name"},[t._v("账号头像")]),t._v(" "),a("div",{staticClass:"box-right avatar-box"},[a("img",{staticClass:"photo",attrs:{src:t.headPortrait,alt:""}}),t._v(" "),a("input",{staticClass:"avatarFile",attrs:{type:"file",accept:"image/*",name:"image"},on:{change:t.handleInputChange}})])]),t._v(" "),a("div",{staticClass:"box-li",on:{click:t.updateUserInfo}},[a("div",{staticClass:"box-left"},[t._v("真实姓名")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.nickName,expression:"nickName"}],staticClass:"box-right ipt-box",attrs:{type:"text",readonly:"",placeholder:"请输入真实姓名"},domProps:{value:t.nickName},on:{input:function(e){e.target.composing||(t.nickName=e.target.value)}}}),t._v(" "),a("img",{staticClass:"more-icon",attrs:{src:"static/images/icon/more-right.png",alt:""}})]),t._v(" "),a("div",{staticClass:"box-li",on:{click:t.updateSex}},[a("div",{staticClass:"box-left"},[t._v("性别")]),t._v(" "),a("div",{staticClass:"box-right"},[0==t.radio?a("span",[t._v("男")]):t._e(),t._v(" "),1==t.radio?a("span",[t._v("女")]):t._e()]),t._v(" "),a("img",{staticClass:"more-icon",attrs:{src:"static/images/icon/more-right.png",alt:""}})]),t._v(" "),a("div",{staticClass:"box-li",on:{click:function(e){t.showDatePicker("birthday")}}},[a("div",{staticClass:"box-left"},[t._v("生日")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.birthday,expression:"birthday"}],ref:"birthday",staticClass:"box-right ipt-box",attrs:{readonly:"",type:"text",placeholder:"请选择出生年月"},domProps:{value:t.birthday},on:{input:function(e){e.target.composing||(t.birthday=e.target.value)}}}),t._v(" "),a("img",{staticClass:"more-icon",attrs:{src:"static/images/icon/more-right.png",alt:""}})]),t._v(" "),a("div",{staticClass:"box-li",on:{click:t.updatePhone}},[a("div",{staticClass:"box-left"},[t._v("电话")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.telePhone,expression:"telePhone"}],staticClass:"box-right ipt-box",attrs:{type:"text",readonly:"",placeholder:"请输入电话"},domProps:{value:t.telePhone},on:{input:function(e){e.target.composing||(t.telePhone=e.target.value)}}}),t._v(" "),a("img",{staticClass:"more-icon",attrs:{src:"static/images/icon/more-right.png",alt:""}})]),t._v(" "),a("div",{staticClass:"box-li",on:{click:t.updateWork}},[a("div",{staticClass:"box-left"},[t._v("岗位")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.job,expression:"job"}],staticClass:"box-right ipt-box",attrs:{type:"text",readonly:"",placeholder:"请输入岗位"},domProps:{value:t.job},on:{input:function(e){e.target.composing||(t.job=e.target.value)}}}),t._v(" "),a("img",{staticClass:"more-icon",attrs:{src:"static/images/icon/more-right.png",alt:""}})]),t._v(" "),a("div",{staticClass:"box-li",on:{click:function(e){t.showDatePicker("entry")}}},[a("div",{staticClass:"box-left"},[t._v("入职时间")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.entryTime,expression:"entryTime"}],ref:"entry",staticClass:"box-right ipt-box",attrs:{readonly:"",type:"text",placeholder:"请选择入职时间"},domProps:{value:t.entryTime},on:{input:function(e){e.target.composing||(t.entryTime=e.target.value)}}}),t._v(" "),a("img",{staticClass:"more-icon",attrs:{src:"static/images/icon/more-right.png",alt:""}})]),t._v(" "),a("div",{staticClass:"box-li",on:{click:t.updateSign}},[a("div",{staticClass:"box-left"},[t._v("个性签名")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.signLabel,expression:"signLabel"}],staticClass:"box-right ipt-box",attrs:{type:"text",readonly:"",placeholder:"留下点什么..."},domProps:{value:t.signLabel},on:{input:function(e){e.target.composing||(t.signLabel=e.target.value)}}}),t._v(" "),a("img",{staticClass:"more-icon",attrs:{src:"static/images/icon/more-right.png",alt:""}})])])]),t._v(" "),a("van-dialog",{on:{confirm:t.comfirmSex},model:{value:t.sexShow,callback:function(e){t.sexShow=e},expression:"sexShow"}},[a("el-radio",{attrs:{label:"0"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("男")]),t._v(" "),a("el-radio",{attrs:{label:"1"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("女")])],1),t._v(" "),a("van-popup",{attrs:{label:"",position:"bottom",overlay:!0},model:{value:t.isPopShow,callback:function(e){t.isPopShow=e},expression:"isPopShow"}},["birthday"===t.datePicker?a("van-datetime-picker",{attrs:{type:"date","min-date":t.birMiniData,"max-date":t.birMaxDate,formatter:t.formatter},on:{cancel:t.cancelPicker,confirm:t.confirmBirthPicker},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}}):t._e(),t._v(" "),"entry"===t.datePicker?a("van-datetime-picker",{attrs:{type:"date","min-date":t.workMiniData,"max-date":t.workMaxDate,formatter:t.formatter},on:{cancel:t.cancelPicker,confirm:t.confirmEntryPicker},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}}):t._e()],1)],1)},staticRenderFns:[]};var l=a("VU/8")(s,c,!1,function(t){a("qET4")},"data-v-69d293b3",null);e.default=l.exports},qET4:function(t,e){}});