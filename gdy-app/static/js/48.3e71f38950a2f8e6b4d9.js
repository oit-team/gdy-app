webpackJsonp([48],{"+QoC":function(t,a,l){"use strict";Object.defineProperty(a,"__esModule",{value:!0});l("XmAh");var o=l("il3B"),s=l("Ylnc"),e=l("SQ1s"),i=l("tdg1"),c={name:"myCollocation",components:{Header:s.a,backHeader:e.a,noGood:i.a},data:function(){return{collStatus:0,tabList:[],totalNum:0,collLoading:!0,collList:[],collTotal:0,currentPage:1,pageSize:8,suitOccaList:[],fromAddColl:!1}},beforeRouteEnter:function(t,a,l){"/addCollocation"==a.path&&l(function(t){t.fromAddColl=!0}),l()},created:function(){this.getShopCollStatus(),this.getSuitList()},mounted:function(){this.getCollList()},activated:function(){localStorage.removeItem("activeSuitList"),localStorage.removeItem("singleList"),localStorage.removeItem("recommentReasonVal"),localStorage.removeItem("collImgListArr"),localStorage.removeItem("shopCollId"),this.getShopCollStatus()},methods:{back:function(){this.$router.push({path:"/index",query:{stamp:(new Date).getTime()}})},getSuitList:function(){var t=this,a={brandId:localStorage.brandId,dType:3,classification:1};t.$axios.post("/api/dic/queryDicList",a).then(function(a){200==a.data.code&&(t.suitOccaList=a.data.data)}).catch(function(a){console.log(a),t.$toast("请求失败--获取适用列表！")})},dealFitOcca:function(t){var a=[];if(t){for(var l=t.split(","),o=0;o<l.length;o++)l[o]&&(l[o]=Number(l[o]));for(var s=0;s<l.length;s++)l[s]||l.splice(s,1);if(l.length>0)for(var e=0;e<l.length;e++)for(var i=0;i<this.suitOccaList.length;i++)l[e]==this.suitOccaList[i].id&&a.push(this.suitOccaList[i].fitOccasionName)}return a},editColl:function(t){this.$router.push({path:"/addCollocation",query:{collId:t,editFlag:!0,collStatus:this.collStatus,stamp:(new Date).getTime()}})},deleteColl:function(t,a){var l=this;o.a.confirm({title:"提示",message:"确认删除该搭配吗？"}).then(function(){var o=l,s={collId:t};o.$axios.post("/api/coll/delColl",s).then(function(t){o.collList.splice(a,1),o.getShopCollStatus()}).catch(function(t){console.log(t)})}).catch(function(){})},toAddColl:function(){this.$router.push({path:"/addCollocation",query:{stamp:(new Date).getTime()}})},clickTab:function(t){this.collStatus=t,this.currentPage=1,this.collList=[],this.collLoading=!0,this.getCollList()},toCollDetail:function(t,a){this.$router.push({path:"/shopCollDetail",query:{collId:t,collStatus:this.collStatus,collInfo:a,stamp:(new Date).getTime()}})},getShopCollStatus:function(){var t=this,a={brandId:localStorage.brandId,userId:localStorage.userId};t.$axios.post("/api/coll/getShopCollStatus",a).then(function(a){"200"==a.data.code?t.tabList=a.data.data:t.$toast(a.data.message)}).catch(function(t){console.log(t)})},getCollList:function(){var t=this,a={brandId:localStorage.brandId,sId:-1,modeId:-1,seasonId:-1,seriesId:-1,styleName:"",currentPage:t.currentPage,pageSize:t.pageSize,type:"2",userId:localStorage.userId,status:t.collStatus};t.$axios.post("/api/coll/collList",a).then(function(a){var l=a.data;if(t.collLoading=!1,"200"==l.code){t.collTotal=l.data.total,1==t.currentPage?t.collList=l.data.list:t.collList=t.collList.concat(l.data.list);for(var o=0;o<t.collList.length;o++){var s=t.dealFitOcca(t.collList[o].fitOccasion);t.$set(t.collList[o],"occaVal",s)}}}).catch(function(t){console.log(t)})},collRefresh:function(){this.currentPage=1,this.getShopCollStatus(),this.getCollList()},collLoadMore:function(){this.collList.length<this.collTotal?(this.currentPage++,this.getCollList()):this.$refs.collBodyScroll.update(!0)}}},n={render:function(){var t=this,a=t.$createElement,l=t._self._c||a;return l("div",{attrs:{id:"myCollocation"}},[l("div",{staticClass:"headBox"},[l("backHeader",{staticStyle:{"background-color":"#f5f5f5"},attrs:{title:"我要搭配"}},[l("span",{staticClass:"head-class f-l",attrs:{slot:"left"},on:{click:t.back},slot:"left"},[t._t("default",[l("img",{staticClass:"back-icon",attrs:{src:"static/images/dev/back@2x.png",alt:""}})])],2),t._v(" "),l("span",{staticClass:"head-class place-label",attrs:{slot:"right"},on:{click:t.toAddColl},slot:"right"},[t._t("default",[l("img",{staticClass:"add-icon",attrs:{src:"static/images/icon/addColl.png",alt:""}})])],2)])],1),t._v(" "),l("div",{staticClass:"tabBox"},t._l(t.tabList,function(a,o){return l("div",{key:o,staticClass:"tabItem",class:t.collStatus==a.status?"active":"",on:{click:function(l){t.clickTab(a.status)}}},[l("span",[t._v(t._s(a.statusName))]),t._v(" "),l("span",[t._v("("+t._s(a.count)+")")])])})),t._v(" "),l("div",{staticStyle:{height:"3px","background-color":"#f5f5f5"}}),t._v(" "),1==t.collLoading?l("div",[l("van-loading",{attrs:{color:"#00a2ea"}})],1):l("Scroll",{ref:"collBodyScroll",staticClass:"collBody",attrs:{"update-data":[t.collList],"refresh-data":[],probeType:3,listenScroll:!0,autoUpdate:!1,scrollX:!1,scrollY:!0},on:{pullingDown:t.collRefresh,pullingUp:t.collLoadMore}},[t.collList.length>0?l("div",{staticClass:"collListBox"},t._l(t.collList,function(a,o){return l("div",{key:o,staticClass:"itemBox",on:{click:function(l){t.toCollDetail(a.id,a)}}},[l("van-swipe-cell",[l("div",{staticClass:"collItem"},[l("img",{staticClass:"collImg",attrs:{src:a.imgUrl,alt:""}}),t._v(" "),l("div",{staticClass:"detail"},[l("div",{staticClass:"collDesc"},[t._v(t._s(a.collInterpretation))]),t._v(" "),l("div",{staticClass:"fitBox"},t._l(a.occaVal,function(a,o){return l("span",{key:o},[t._v(t._s(a))])})),t._v(" "),l("div",{staticClass:"otherBox"},[l("span",{staticClass:"time"},[t._v(t._s(a.createDate))]),t._v(" "),a.aeNumber?l("span",{staticClass:"praiseBox"},[l("img",{staticClass:"praiseIcon",attrs:{src:"static/images/icon/praise-grey.png",alt:""}}),t._v(" "),l("span",{staticClass:"praiseNum"},[t._v(t._s(a.aeNumber))])]):t._e()])])]),t._v(" "),1!=t.collStatus?l("template",{slot:"right"},[3!=t.collStatus?l("van-button",{attrs:{square:"",type:"primary",text:"编辑"},on:{click:function(l){t.editColl(a.id)}}}):t._e(),t._v(" "),l("van-button",{attrs:{square:"",type:"danger",text:"删除"},on:{click:function(l){t.deleteColl(a.id,o)}}})],1):t._e()],2)],1)})):l("div",{staticStyle:{"padding-top":"0.5px"}},[l("noGood")],1)])],1)},staticRenderFns:[]};var r=l("VU/8")(c,n,!1,function(t){l("higl")},"data-v-1ad6ed49",null);a.default=r.exports},higl:function(t,a){}});